<!DOCTYPE html>
<html>
<style>
    .form {
        border: 4px solid rgb(8, 8, 8);
        border-radius: 8px;
        width: 400px;
        height: 400px;
        background-color: rgb(134, 130, 122);
        position: fixed;
        top: 30%;
        left: 40%;
        color: white;

    }

    #myform {
        padding: 40px 50px;
    }

    input[type=text] {
        width: 100%;
    }

    input[type=submit] {
        width: 100%;
        background-color: #4CAF50;
        color: white;

    }

    input[type=submit]:hover {
        background-color: #45a049;
    }


    input[type=button] {
        width: 100%;
        background-color: #4CAF50;
        color: white;

    }

    input[type=button]:hover {
        background-color: #45a049;
    }
</style>

<head>
    <link rel="stylesheet" href="header.css">
    <link href='https://fonts.googleapis.com/css?family=Alice' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <header class="navbar1">

    <div class="navbar" id="myHeader">
      <a href="http://localhost:5000/login">Login</a>

      <div class="subnav">
        <button class="subnavbtn">About <i class="fa fa-caret-down"></i></button>
        <div class="subnav-content">
          <a href="#contactus">Contact us</a><br>
          <a href="#team">Team</a>
        </div>
      </div>
      <a href="http://localhost:5000/login">Donate</a>
      <div class="subnav">
        <button class="subnavbtn">Activities <i class="fa fa-caret-down"></i></button>
        <div class="subnav-content">
          <a href="http://localhost:5000/event">Events</a><br>
          <a href="http://localhost:5000/campaign">Camapaigns</a>
        </div>
      </div>
      <a href="http://localhost:5000/ngo">Home</a> 
    </div>
    <div>
      
        <div style="float: right;"  class="open-divsearch" onclick="show()" onmouseout="hide()">
          <input type="text" name="search" id="myInput" placeholder="search here" onkeyup="searchFunc()" style="width: 1753px;" onfocus="show()" autocomplete="off" class="open-search" >
          <button type="submit" onclick="redir()"><i class="fa fa-search"></i></button>         
          <div id="myTable" style="display:none;width: 1753px;" onmouseover="show()" class="table" ></div>
        </div>
        
    </div>
  
   
   
  </header>

    
    <div class="form">
        <form name="myform" id="myform" onsubmit="return check()">
            Name:
            <input type="text" name="name" id="name">
            </br>
            Address:
            <input type="text" name="address" id="address">
            </br>
            email id:
            <input type="text" name="emailid" id="emailid">
            </br>
            username:
            <input type="text" name="username" id="username">
            </br>
            password:
            <input type="text" name="password" id="password">
            </br>
            confirm password:
            <input type="text" name="cpassword" id="cpassword" onblur="checkEmail()">
            </br>
            Mobileno:
            <input type="text" name="mobilno" id="mobileno">
            </br>
            <input type="submit" value="submit">
        </form>
    </div>
    <script>

        function checkvalue() {
            var flag = "false";
            if (myform.name.value && myform.address.value && myform.mobileno.value && myform.emailid.value && myform.username.value && myform.password.value && myform.cpassword.value) {
                flag = "true";

            }
            else {

                alert('Enter all fields!');
            }
            return flag;

        }
        function checkEmail() {
            var flag = "true";
            if (myform.password.value != myform.cpassword.value) {
                document.getElementById('cpassword').style.borderColor = "red";
                alert('password doesn\'t match!');
                return false;
            }

        }
        function check() {

            var flag = checkvalue();
            var flag2 = checkEmail();
            if (flag && flag2) {
                var fd = document.getElementById("myform");

                var formData = {
                    'Name': fd.name.value,
                    'Address': fd.address.value,
                    'Mobileno': fd.mobileno.value,
                    'Emailid': fd.emailid.value,
                    'Username': fd.username.value,
                    'Password': fd.password.value

                }

                fetch("http://localhost:3000/register", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),

                })
                    .then((response) => {
                        return response.text();
                    })
                    .then((mytext) => {
                        window.location.href = mytext;
                        console.log(mytext);
                    })

                    .catch(function () {
                        console.log("error");
                    });



                return false;
            }

        }

        function redir() {
    var name = document.getElementById('myInput');
    console.log("he;" + name.value);
    fetch("http://localhost:3000/display_camp.html/" + name.value.toUpperCase(), options)
      .then((response) => {
        return response.json();
      }).then((dis) => {
        dis.forEach(function (disp) {
          if (name.value.toUpperCase() == disp.c_name.toUpperCase()) {
            console.log("dis " + disp.c_name)
            window.location = "http://localhost:5000/display_camp?" + disp.c_name.toUpperCase();
          }
        })
      })
      .catch(function () {
        console.log("error");
      });
    fetch("http://localhost:3000/display_event.html/" + name.value.toUpperCase(), options)
      .then((response) => {
        return response.json();
      }).then((dis) => {
        dis.forEach(function (disp) {
          if (name.value.toUpperCase() == disp.e_name.toUpperCase()) {
            window.location = "http://localhost:5000/display_event?" + disp.e_name.toUpperCase();
          }
        })
      })
      .catch(function () {
        console.log("error");
      });
  }




  const show = () => {
    let myTable = document.getElementById('myTable');
    myTable.style.display = "";
  }
  const hide = () => {
    let myTable = document.getElementById('myTable');
    myTable.style.display = "none";
  }

  const searchFunc = () => {
    let filter = document.getElementById('myInput').value.toUpperCase();
    let myTable = document.getElementById('myTable');
    let tr = myTable.getElementsByTagName('tr');
    for (var i = 0; i < tr.length; i++) {
      let td = tr[i].getElementsByTagName('td')[0];
      if (td) {
        let textvalue = td.textContent || td.innerHTML;
        if (textvalue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        }
        else {
          tr[i].style.display = "none";
        }
      }
    }
  }
  function attachFetch(fetchAll)
{
    const a=document.getElementById("myTable");
    const table = document.createElement('table');
    const tr = document.createElement('tr');
    const td = document.createElement('td');
    const alink=document.createElement('a');
    if(fetchAll.type=='C')
    {
      alink.setAttribute("href","http://localhost:5000/display_camp?"+fetchAll.c_name);
      alink.innerText=fetchAll.c_name;
    }
    else if(fetchAll.type=='E')
    {
      alink.setAttribute("href","http://localhost:5000/display_event?"+fetchAll.e_name);
      alink.innerText=fetchAll.e_name;
    }
    else
    {
      //logic of article
    }
    td.appendChild(alink);
    tr.appendChild(td);
    table.appendChild(tr);
    a.appendChild(table);
}
function load()
{
  
    fetch("http://localhost:3000/campFetch",options)
    .then((response) => {
      return response.json();
    })
    .then((campaign) => {
      campaign.forEach(function (camp) {
      attachFetch(camp);       
      })
    })
    .catch(function () {
    console.log("error");
     });
    fetch("http://localhost:3000/eventFetch",options)
    .then((response) => {
      return response.json();
    })
    .then((events) => {
      events.forEach(function (event) {
      attachFetch(event);        
    })
  })
  .catch(function () {
    console.log("error");
  });
      
}
    </script>
<footer class="footer">
    <a href="#">fb</i></a>
    <a href="#">pintrest</i></a>
    <a href="#">twitter</i></a>
    <a href="#">flickr</i></a>
    <a href="#">linkedin</i></a>
    <p class="">
     Powered by <a href="#" target="_blank">@</a>
    </p>
  </footer>
</body>

</html>